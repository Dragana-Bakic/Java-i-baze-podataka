CREATE DATABASE Sistem_biblioteka

CREATE TABLE Biblioteke(
    BibliotekaId INT PRIMARY KEY AUTO_INCREMENT,
    nazivBiblioteke VARCHAR(45) NOT NULL,
    Grad VARCHAR(45) NOT NULL,
    Adresa VARCHAR(45) NOT NULL,
    adresaBroj VARCHAR(45) NOT NULL,
    telefon VARCHAR(45)
) ENGINE = INNODB;

CREATE TABLE IF NOT EXISTS Članovi(
    ČlanskaKarta INT PRIMARY KEY,
    Ime VARCHAR(45) NOT NULL,
    Prezime VARCHAR(45) NOT NULL,
    DatumRođenja DATE NOT NULL,
    Telefon VARCHAR(45),
    Grad VARCHAR(45) NOT NULL,
    Adresa VARCHAR(45) NOT NULL,
    adresaBroj VARCHAR(45) NOT NULL,
    BibliotekaID INT,
    FOREIGN KEY(BibliotekaID) REFERENCES biblioteke(BibliotekaID) ON UPDATE CASCADE ON DELETE NO ACTION
) ENGINE = INNODB;

CREATE TABLE IF NOT EXISTS Bibliotekari(
    JMBG INT(13) PRIMARY KEY,
    Ime VARCHAR(45) NOT NULL,
    Prezime VARCHAR(45) NOT NULL,
    ŠifraZaposlenog VARCHAR(45) NOT NULL,
    Telefon VARCHAR(45),
    Grad VARCHAR(45) NOT NULL,
    Adresa VARCHAR(45) NOT NULL,
    adresaBroj VARCHAR(45) NOT NULL,
    BibliotekaID INT,
    FOREIGN KEY(BibliotekaID) REFERENCES biblioteke(BibliotekaID) ON UPDATE CASCADE ON DELETE NO ACTION
) ENGINE = INNODB;

CREATE TABLE IF NOT EXISTS DečijeOdeljenje(
    DečijeOdeljenjeID INT PRIMARY KEY AUTO_INCREMENT,
    Uzrast VARCHAR(45) NOT NULL
) ENGINE = INNODB;

CREATE TABLE IF NOT EXISTS PozajmnoOdeljenje(
    PozajmnoOdeljenjeID INT PRIMARY KEY AUTO_INCREMENT,
    Aktuelnost VARCHAR(45) NOT NULL,
    Žanr VARCHAR(45) NOT NULL
) ENGINE = INNODB;

CREATE TABLE IF NOT EXISTS NaučnoOdeljenje(
    NaučnoOdeljenjeID INT PRIMARY KEY AUTO_INCREMENT,
    NaučnaOblast VARCHAR(45) NOT NULL
) ENGINE = INNODB;

CREATE TABLE IF NOT EXISTS Odeljenja(
    OdeljenjeID INT PRIMARY KEY AUTO_INCREMENT,
    NazivOdeljenja ENUM('dečije', 'pozajmno', 'naučno') NOT NULL,
    DečijeOdeljenjeID INT,
    PozajmnoOdeljenjeID INT,
    NaučnoOdeljenjeID INT,
    FOREIGN KEY(DečijeOdeljenjeID) REFERENCES DečijeOdeljenje(DečijeOdeljenjeID) ON UPDATE CASCADE ON DELETE NO ACTION,
    FOREIGN KEY(PozajmnoOdeljenjeID) REFERENCES PozajmnoOdeljenje(PozajmnoOdeljenjeID) ON UPDATE CASCADE ON DELETE NO ACTION,
    FOREIGN KEY(NaučnoOdeljenjeID) REFERENCES NaučnoOdeljenje(NaučnoOdeljenjeID) ON UPDATE CASCADE ON DELETE NO ACTION
) ENGINE = INNODB;

CREATE TABLE IF NOT EXISTS Knjige(
    ISBN INT(13) PRIMARY KEY,
    Naziv VARCHAR(45) NOT NULL,
    jezičkaGrupa VARCHAR(45) NOT NULL,
    OdeljenjeID INT NOT NULL,
    FOREIGN KEY(OdeljenjeID) REFERENCES Odeljenja(OdeljenjeID) ON UPDATE CASCADE ON DELETE NO ACTION
) ENGINE = INNODB;

CREATE TABLE IF NOT EXISTS BibliotekeKnjige(
    BibliotekaKnjigaID INT PRIMARY KEY AUTO_INCREMENT,
    ISBN INT(13),
    BibliotekaID INT,
    FOREIGN KEY(ISBN) REFERENCES Knjige(ISBN) ON UPDATE CASCADE ON DELETE NO ACTION,
    FOREIGN KEY(BibliotekaID) REFERENCES biblioteke(BibliotekaID) ON UPDATE CASCADE ON DELETE NO ACTION
) ENGINE = INNODB;

CREATE TABLE IF NOT EXISTS Autori(
    AutorID INT PRIMARY KEY AUTO_INCREMENT,
    Ime VARCHAR(45) NOT NULL,
    Prezime VARCHAR(45) NOT NULL
) ENGINE = INNODB;

CREATE TABLE IF NOT EXISTS Izdavači(
    IzdavačID INT PRIMARY KEY AUTO_INCREMENT,
    NazivIzdavača VARCHAR(45) NOT NULL,
    ISBN INT(13),
    AutorID INT,
    FOREIGN KEY(ISBN) REFERENCES Knjige(ISBN) ON UPDATE CASCADE ON DELETE NO ACTION,
    FOREIGN KEY(AutorID) REFERENCES Autori(AutorID) ON UPDATE CASCADE ON DELETE NO ACTION
) ENGINE = INNODB;

CREATE TABLE IF NOT EXISTS Izdavanje(
    IzdavanjeID INT PRIMARY KEY AUTO_INCREMENT,
    datumIzdavanja DATE NOT NULL,
    datumVraćanja DATE,
    ISBN INT(13) NOT NULL,
    JMBG INT(13) NOT NULL,
    ČlanskaKarta INT NOT NULL,
    FOREIGN KEY(ISBN) REFERENCES Knjige(ISBN) ON UPDATE CASCADE ON DELETE NO ACTION,
    FOREIGN KEY(JMBG) REFERENCES bibliotekari(JMBG) ON UPDATE CASCADE ON DELETE NO ACTION,
    FOREIGN KEY(ČlanskaKarta) REFERENCES Članovi(ČlanskaKarta) ON UPDATE CASCADE ON DELETE NO ACTION
) ENGINE = INNODB;

